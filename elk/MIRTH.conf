filter {
   if [type] == "dockerlogs" {
     if "MIRTH" in [tags] {
        grok {
            match => { "message" => "%{LOGLEVEL:level} %{URIHOST:date} %{TIME:log_timestamp} %{SYSLOG5424SD:syslog}\s+%{GREEDYDATA:mirth_msg}" }
        }
        grok {
          match => [ "mirth_msg", "postprocessor: %{SYSLOG5424SD:channel} %{SYSLOG5424SD:destination} %{SYSLOG5424SD:errormsg}" ]
        }
         mutate {
            add_field => { "logtrail" => "mirth" }
         }
         mutate {
               replace => [ "log_timestamp", "%{date} %{log_timestamp}" ]
         }
          date { 
              match => [ "log_timestamp", "yyyy-MM-dd HH:mm:ss,SSS"] 
            }
     }
  } 
}
